<div class="container mat-typography" style="padding: 30px">
  <!-- En-t√™te avec logo et date -->
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <div style="display: flex; align-items: center;">
      <img src="logo.png" alt="Logo" style="height: 60px; margin-right: 20px;" />
      <h1 style="margin: 0;">Liste de colisage</h1>
    </div>
    <span>{{ currentDate | date:'fullDate' }}</span>
  </div>

  <!-- Zone de recherche -->
  <mat-form-field appearance="outline" style="width: 100%; max-width: 400px; margin-bottom: 20px;">
    <mat-label>Rechercher par R√©f√©rence</mat-label>
    <input matInput [(ngModel)]="searchQuery" (input)="filterDataByReference()" placeholder="Ex: 123ABC" />
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>

  <!-- Upload fichier Excel -->
  <div style="margin-bottom: 20px;">
    <input type="file" (change)="onFileChange($event)" accept=".xlsx,.xls" />
  </div>

  <!-- Tableau des accessoires -->
  <mat-card>
    <div class="mat-elevation-z8">
      <table mat-table [dataSource]="filteredData" class="full-width-table">

        <!-- Colonne Syst√®me -->
        <ng-container matColumnDef="systeme">
          <th mat-header-cell *matHeaderCellDef> Syst√®me </th>
          <td mat-cell *matCellDef="let item"> {{ item['Syst√®me'] }} </td>
        </ng-container>

        <!-- Colonne Image -->
        <ng-container matColumnDef="image">
          <th mat-header-cell *matHeaderCellDef> Image </th>
          <td mat-cell *matCellDef="let item">
            <img *ngIf="item['Image']" [src]="item['Image']" width="50" alt="Image" />
          </td>
        </ng-container>

        <!-- Colonne R√©f√©rence -->
        <ng-container matColumnDef="reference">
          <th mat-header-cell *matHeaderCellDef> R√©f√©rence </th>
          <td mat-cell *matCellDef="let item"> {{ item['R√©f√©rence'] }} </td>
        </ng-container>

        <!-- Colonne Finition -->
        <ng-container matColumnDef="finition">
          <th mat-header-cell *matHeaderCellDef> Finition </th>
          <td mat-cell *matCellDef="let item"> {{ item['Finition'] }} </td>
        </ng-container>

        <!-- Colonne D√©signation -->
        <ng-container matColumnDef="designation">
          <th mat-header-cell *matHeaderCellDef> D√©signation </th>
          <td mat-cell *matCellDef="let item"> {{ item['D√©signation'] }} </td>
        </ng-container>

        <!-- Colonne Quantit√© -->
        <ng-container matColumnDef="quantite">
          <th mat-header-cell *matHeaderCellDef> Quantit√© </th>
          <td mat-cell *matCellDef="let item"> {{ item['Quantit√©'] }} </td>
        </ng-container>

        <!-- ‚úÖ Colonne Nombre (quantit√© saisie manuellement) -->
        <ng-container matColumnDef="nombre">
          <th mat-header-cell *matHeaderCellDef> Nombre </th>
          <td mat-cell *matCellDef="let item">
            <input type="number" [(ngModel)]="item.nombre" min="0" style="width: 60px; padding: 5px;" />
          </td>
        </ng-container>

        <!-- Colonne S√©lection -->
        <ng-container matColumnDef="select">
          <th mat-header-cell *matHeaderCellDef> S√©lectionner </th>
          <td mat-cell *matCellDef="let item">
            <button mat-raised-button color="accent" (click)="toggleSelection(item)">
              {{ selectedItems.includes(item) ? 'D√©s√©lectionner' : 'S√©lectionner' }}
            </button>
          </td>
        </ng-container>

        <!-- En-t√™te et ligne -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </mat-card>

  <!-- Bouton PDF -->
  <div style="text-align: right; margin-top: 20px;">
    <button mat-flat-button color="primary" (click)="generatePDF()">
      üñ®Ô∏è G√©n√©rer le PDF
    </button>
  </div>
</div>
